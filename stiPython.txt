if PE == 0: # Executing in real-address mode 
    IF = 1 # Set Interrupt Flag 
else: # Executing in protected mode or virtual-8086 mode 
    if VM == 0: # Executing in protected mode
        if IOPL >= CPL:
            IF = 1 # Set Interrupt Flag 
        else:
            if (IOPL < CPL) and (CPL == 3) and (PVI == 1):
                VIF = 1 # Set Virtual Interrupt Flag 
            else:
                exitStatus = GP
    else: # Executing in Virtual-8086 mode 
        if IOPL == 3:
            IF = 1 # Set Interrupt Flag 
        else:
            if ((IOPL < 3) and (VIP == 0) and (VME == 1)):
                VIF = 1 # Set Virtual Interrupt Flag 
            else:
                exitStatus = GP # Trap to virtual-8086 monitor 
